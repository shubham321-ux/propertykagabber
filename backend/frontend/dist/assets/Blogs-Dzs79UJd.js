import{r as s,j as e,a as A,J as P,K as _,M as F}from"./index-CzvIclpe.js";import{A as M}from"./AdminActionLoader-DeB0H1CL.js";import{c as z,E as R,P as U}from"./pen-BbEfULXZ.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],q=z("trash-2",V);function H(){const[g,d]=s.useState([]),[n,u]=s.useState({title:"",description:"",content:""}),[x,b]=s.useState(null),[f,y]=s.useState(null),[C,j]=s.useState(!0),[S,i]=s.useState(!1),[a,c]=s.useState(null),[o,w]=s.useState(null),[v,p]=s.useState(null),[N,m]=s.useState(null),D=async()=>{try{j(!0);const t=await A();d(Array.isArray(t)?t:[])}catch(t){console.error("Error loading blogs:",t)}finally{j(!1)}};s.useEffect(()=>{D()},[]);const k=async t=>{t.preventDefault(),i(!0);const l=new FormData;l.append("title",n.title),l.append("description",n.description),l.append("content",n.content),x&&l.append("image",x);try{const r=await P(l);d([r,...g]),u({title:"",description:"",content:""}),b(null),y(null),alert("✅ Blog created successfully!")}catch(r){console.error(r),alert("❌ Failed to create blog")}finally{i(!1)}},E=async t=>{if(window.confirm("Delete this blog?")){i(!0);try{await _(t),d(l=>l.filter(r=>r._id!==t)),alert("🗑️ Blog deleted successfully!")}catch(l){console.error(l),alert("❌ Failed to delete blog")}finally{i(!1)}}},I=async t=>{if(t.preventDefault(),!a)return;i(!0);const l=new FormData;l.append("title",a.title),l.append("description",a.description),l.append("content",a.content),v&&l.append("image",v);try{const r=await F(a._id,l);d(L=>L.map(B=>B._id===r._id?r:B)),c(null),p(null),m(null),alert("✅ Blog updated successfully!")}catch(r){console.error(r),alert("❌ Failed to update blog")}finally{i(!1)}},h=t=>t?t.startsWith("http")?t:`${window.location.origin}${t}`:null;return e.jsxs("div",{className:"relative max-w-[1400px] mx-auto p-6",children:[S&&e.jsx(M,{message:"Processing Blog..."}),e.jsx("h2",{className:"text-2xl font-bold text-primary mb-6",children:"Manage Blogs"}),e.jsxs("form",{onSubmit:k,className:"bg-white shadow-md rounded-lg p-6 mb-6 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Blog Title",value:n.title,onChange:t=>u({...n,title:t.target.value}),required:!0,className:"w-full border rounded px-3 py-2"}),e.jsx("input",{type:"text",placeholder:"Short Description",value:n.description,onChange:t=>u({...n,description:t.target.value}),required:!0,className:"w-full border rounded px-3 py-2"}),e.jsx("textarea",{placeholder:"Full Blog Content",value:n.content,onChange:t=>u({...n,content:t.target.value}),required:!0,rows:5,className:"w-full border rounded px-3 py-2"}),e.jsx("input",{type:"file",onChange:t=>{const l=t.target.files[0];b(l),y(l?URL.createObjectURL(l):null)},className:"w-full"}),f&&e.jsx("img",{src:f,alt:"Preview",className:"w-28 h-20 object-cover rounded"}),e.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary-light transition",children:"➕ Add Blog"})]}),C?e.jsx("p",{className:"text-gray-500",children:"Loading blogs..."}):g.length===0?e.jsx("p",{className:"text-gray-500",children:"No blogs found."}):e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 border-b text-left",children:"Title"}),e.jsx("th",{className:"p-3 border-b text-left",children:"Description"}),e.jsx("th",{className:"p-3 border-b text-left",children:"Image"}),e.jsx("th",{className:"p-3 border-b text-right",children:"Actions"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition border-b",children:[e.jsx("td",{className:"p-3 font-medium",children:t.title}),e.jsxs("td",{className:"p-3 text-sm text-gray-600",children:[t.description||t.content.slice(0,60),"..."]}),e.jsx("td",{className:"p-3",children:t.image&&e.jsx("img",{src:h(t.image),alt:t.title,className:"w-20 h-16 object-cover rounded"})}),e.jsxs("td",{className:"p-3 text-right flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>w(t),className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600",title:"View Details",children:e.jsx(R,{size:18})}),e.jsx("button",{onClick:()=>c(t),className:"bg-yellow-500 text-white p-2 rounded hover:bg-yellow-600",title:"Edit Blog",children:e.jsx(U,{size:18})}),e.jsx("button",{onClick:()=>E(t._id),className:"bg-red-600 text-white p-2 rounded hover:bg-red-700",title:"Delete Blog",children:e.jsx(q,{size:18})})]})]},t._id))})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-primary mb-4",children:o.title}),o.image&&e.jsx("img",{src:h(o.image),alt:o.title,className:"w-full h-64 object-cover rounded mb-4"}),e.jsxs("p",{className:"text-gray-700 mb-3",children:[e.jsx("b",{children:"Description:"})," ",o.description]}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:o.content}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>w(null),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Close"})})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("form",{onSubmit:I,className:"bg-white p-6 rounded-lg shadow-lg w-96 space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-primary",children:"✏️ Edit Blog"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>c({...a,title:t.target.value}),className:"w-full border rounded px-3 py-2"}),e.jsx("input",{type:"text",value:a.description||"",placeholder:"Short Description",onChange:t=>c({...a,description:t.target.value}),className:"w-full border rounded px-3 py-2"}),e.jsx("textarea",{value:a.content,onChange:t=>c({...a,content:t.target.value}),rows:5,className:"w-full border rounded px-3 py-2"}),e.jsx("input",{type:"file",onChange:t=>{const l=t.target.files[0];p(l),m(l?URL.createObjectURL(l):null)},className:"w-full"}),N?e.jsx("img",{src:N,alt:"New Preview",className:"w-28 h-20 object-cover rounded"}):a.image&&e.jsx("img",{src:h(a.image),alt:"Current",className:"w-28 h-20 object-cover rounded"}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{c(null),p(null),m(null)},className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary-light",children:"Save"})]})]})})]})}export{H as default};
